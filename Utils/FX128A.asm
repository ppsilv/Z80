
	ORG	#8040
	DISP   #4040
BUFER	EQU	#6000
BUFLEN	EQU	#4000
	DI 
	LD	A,#40
	LD	(LENBL),A
	LD	(L4B89),SP
	CALL	L4860
	LD	HL,0
	LD	(L48D2),HL
	LD	HL,TEXT1
	CALL	L4AA3
	LD	HL,#307
	LD	(L48D2),HL
	LD	HL,TEXT2
	CALL	L4AA3
	CALL	L4F89
L489D	CALL	L4860
L48A0	LD	B,8
	CALL	L4A8E
	CALL	L4F8C
	CP	"Q"
	JP	Z,L4B83
	CP	"J"
	JP	Z,L52CD
	LD	HL,L4960
	LD	C,A
L48BA	LD	A,(HL)
	AND	A
	JR	Z,L48A0
	CP	C
	JR	Z,L48C6
	INC	HL
	INC	HL
	INC	HL
	JR	L48BA
L48C6	INC	HL
	LD	E,(HL)
	INC	HL
	LD	D,(HL)
	EX	DE,HL
	LD	DE,L48A0
	PUSH	DE
	JP	(HL)
L4860	LD	A," "
	LD	BC,#F4
CLS1	OUT	(#F5),A
	OUT	(C),B
	DJNZ	CLS1
	RET 
L48D7	CALL	L4A7C		;-B-
	LD	HL,L4BC3
	CALL	L4AA3
	LD	A,3
	CALL	L4D69
	JP	C,L4A7C
	LD	A,"="
	CALL	L4FC7
	LD	B,8
L48EE	XOR	A
	RL	L
	ADC	A,"0"
	CALL	L4FC7
	DJNZ	L48EE
	CALL	L4F89
	JP	L4A7C
L4960	DEFB	"M"
	DEFW	L499D
	DEFB	"H"
	DEFW	L4A6D
	DEFB	"A"
	DEFW	L4A60
	DEFB	"6"
	DEFW	L49B1
	DEFB	"7"
	DEFW	L49CE
	DEFB	"5"
	DEFW	L49D6
	DEFB	"8"
	DEFW	L5000
	DEFB	"O"
	DEFW	L500D
	DEFB	"I"
	DEFW	L5174
	DEFB	"C"
	DEFW	L5174
	DEFB	"D"
	DEFW	L51B8
	DEFB	"F"
	DEFW	L5228
	DEFB	"T"
	DEFW	L5208
	DEFB	"G"
	DEFW	L5245
	DEFB	"B"
	DEFW	L48D7
	DEFB	"N"
	DEFW	L52A1
	DEFB	"W"
	DEFW	L52EA
	DEFB	"L"
	DEFW	L504C
	DEFB	"S"
	DEFW	SAV_COD
	DEFB	"P"
	DEFW	PERFO
	DEFB	"K"
	DEFW	KOPY
	DEFB	"E"
	DEFW	PERFOEN
	DEFB	"*"
	DEFW	MONCOPY
	DEFB	"?"
	DEFW	HELL
	DEFB	0
L499D	CALL	L4A7C		;-M-
	LD	HL,L4B90
	CALL	L4AA3
	CALL	L4D67
	JP	C,L4A7C
	LD	(L4B8B),HL
	JP	L4A7C
L49B1	LD	A,(L4B8D)	;-6-
	BIT	1,A
	JR	NZ,L49C6
	LD	A,#C9
	LD	(L4FC7),A
	CALL	L556C
	LD	A,#E5
	LD	(L4FC7),A
	RET 
L49C6	LD	HL,(L4B8B)
	INC	HL
	LD	(L4B8B),HL
	RET 
L49CE	LD	HL,(L4B8B)	;-7-
	DEC	HL
;	LD	(L6B8B),HL
	RET 
L49D6	LD	A,(L4B8D)	;-5-
	BIT	1,A
	JR	NZ,L49F1
	LD	A,#C9
	LD	(L4FC7),A
	LD	B,8
L49E4	PUSH	BC
	CALL	L556C
	POP	BC
	DJNZ	L49E4
	LD	A,#E5
	LD	(L4FC7),A
	RET 
L49F1	LD	HL,(L4B8B)
	LD	DE,8
	ADD	HL,DE
	LD	(L4B8B),HL
	RET 
L4A60	CALL	L4860		;-A-
	LD	A,(L4B8D)
	XOR	2
	JR	L4A78
L4A6D	CALL	L4860		;-H-
	LD	A,(L4B8D)
	XOR	1
L4A78	LD	(L4B8D),A
	RET 
L4A7C	LD	HL,#700
	LD	(L48D2),HL
L4A82	LD	B,#20
L4A84	CALL	L4FC5
	DJNZ	L4A84
	XOR	A
	LD	(L48D2),A
	RET 
L4A8E	LD	A,(L4B8D)
	BIT	1,A
	JP	NZ,L5795
	JP	L554E
L4A99	LD	A,(L4B8D)
	BIT	0,A
	RET	Z
	LD	A,"#"
	JP	L4FC7
L4AA3	LD	A,(HL)
	INC	HL
	BIT	7,A
	RES	7,A
	CALL	L4FC7
	JR	Z,L4AA3
	RET 
L4AAAF	LD	HL,L4B8D
	BIT	0,(HL)
	JP	Z,L4CON
	PUSH	AF
	LD	A,"#"
	CALL	L4FC7
	POP	AF
	JP	L4B6D
L4AAF	LD	HL,L4B8D
	BIT	0,(HL)
	JP	NZ,L4B6D
L4CON	LD	H,0
	LD	L,A
	JR	L4AC4
L4ABC	LD	A,(L4B8D)
	BIT	0,A
	JP	NZ,L4B681
L4AC4	PUSH	BC
	LD	C,1
	JR	L4ACC
L4AC9	PUSH	BC
	LD	C,0
L4ACC	PUSH	DE
	CALL	L4AD3
	POP	DE
	POP	BC
	RET 
L4AD3	LD	DE,10000
	CALL	L4AF0
	LD	DE,1000
	CALL	L4AF0
	LD	DE,100
	CALL	L4AF0
	LD	DE,10
	CALL	L4AF0
	LD	A,L
	ADD	A,"0"
	JP	L4FC7
L4AF0	XOR	A
L4AF1	INC	A
	SBC	HL,DE
	JR	NC,L4AF1
	ADD	HL,DE
	CP	C
	RET	Z
	DEC	C
	ADD	A,#2F
	JP	L4FC7
L4B60	LD	A,(L4B8D)
	BIT	0,A
	JR	Z,L4AC9
L4B681	LD	A,"#"
	CALL	L4FC7
L4B68	LD	A,H
	CALL	L4B6D
	LD	A,L
L4B6D	PUSH	AF
	RRCA 
	RRCA 
	RRCA 
	RRCA 
	CALL	L4B76
	POP	AF
L4B76	AND	#0F
	ADD	A,#90
	DAA 
	ADC	A,#40
	DAA 
	JP	L4FC7
L4B83	LD	A,"*"
	OUT	(#F5),A
	XOR	A
	OUT	(#F4),A
	LD	SP,(L4B89)
	EI 
	JP	#B99
L4C60	LD	HL,L48D1
	LD	A,(HL)
	SUB	B
	LD	B,A
	DEC	(HL)
	INC	HL
	LD	A,(HL)
	SUB	B
	LD	(HL),A
	CALL	L4EEC
	LD	A,(L48D1)
	LD	B,A
	LD	A,#23
	CALL	L4FC7
	LD	HL,L4B8D
	SET	2,(HL)
	CALL	L4E6C
	LD	HL,L4BF9
L4C86	CALL	L4F60
	CP	#08
	CALL	Z,L4E7D
	JR	Z,L4C86
	CP	"<"
	JR	Z,L4CB7
	CP	"0"
	JP	C,L4E69
	CP	"F"+1
	JP	NC,L4E69
	CP	"9"+1
	JR	C,L4CA7
	CP	"A"
	JP	C,L4E69
L4CA7	LD	A,B
	OR	A
	JR	Z,L4C86
	LD	A,E
	CALL	L4FC7
	LD	(HL),A
	CALL	L4E6C
	INC	HL
	DEC	B
	JR	L4C86
L4CB7	LD	A,#48
	LD	(HL),A
	INC	HL
	CALL	L4EC5
	XOR	A
	LD	A,B
	RET 
L4CC1	LD	A,16
L4CC3	LD	(L48D1),A
	LD	B,A
	CALL	L4E6C
	LD	HL,L4B8D
	RES	2,(HL)
	LD	HL,L4DBD
L4CD7	CALL	L4F60
	CP	8
	CALL	Z,L4E7D	 ;DELETE OF CHAR
	JR	Z,L4CD7	 ;NEXT CHAR
	CP	"<"
	JR	Z,L4CFA
	CP	" "
	JP	Z,L4E69	 ;BAD CHAR
	LD	A,B
	OR	A
	JR	Z,L4CD7	 ;NEXT CHAR
	LD	A,E
	CALL	L4FC7
	LD	(HL),A
	CALL	L4E6C
	INC	HL
	DEC	B
	JR	L4CD7
L4CFA	LD	A,#80
	LD	(HL),A
	XOR	A
	RET 
L4D67	LD	A,5
L4D69	LD	(L48D1),A
	LD	B,A
	LD	A,(L4B8D)
	BIT	0,A
	JP	NZ,L4C60
	LD	A,B
L4D76	LD	B,A
	CALL	L4E6C
	LD	HL,L4B8D
	RES	2,(HL)
	LD	HL,L4BF9
L4D86	CALL	L4F60
	CP	8
	CALL	Z,L4E7D
	JR	Z,L4D86
	CP	"#"
	JP	Z,L4C60
	CP	"<"
	JR	Z,L4DB0
	SUB	"0"
	CP	10
	JP	NC,L4E69
	LD	A,B
	OR	A
	JR	Z,L4D86
	LD	A,E
	CALL	L4FC7
	LD	(HL),A
	CALL	L4E6C
	INC	HL
	DEC	B
	JR	L4D86
L4DB0	LD	A,#40
	LD	(HL),A
	PUSH	BC
	CALL	L4EA8
	POP	BC
	XOR	A
	DEC	A
	OR	A
	LD	A,B
	RET 
L4E60	LD	DE,#1000
L4E63	DEC	DE
	LD	A,D
	OR	E
	JR	NZ,L4E63
	RET 
L4E69	LD	A,E
	SCF 
	RET 
L4E6C	LD	A,#C6
	LD	(L4FF5),A
	LD	A,#80
	LD	(L4FF5+1),A
	LD	A," "
	CALL	L4FC7
	XOR	A
	LD	(L4FF5),A
	LD	(L4FF5+1),A
	CALL	L4FC5
	PUSH	HL
	LD	HL,L48D2
	DEC	(HL)
	DEC	(HL)
	POP	HL
	RET 
L4E7D	LD	A,(L48D1)
	CP	B
	JR	NZ,L4E9A
	LD	A,(L4B8D)
	BIT	2,A
	JR	Z,L4EA6
	POP	HL
	LD	A,(L48D1)
	INC	A
	LD	(L48D1),A
	PUSH	AF
	CALL	L4E9C
	POP	AF
	JP	L4D76
L4E9A	INC	B
	DEC	HL
L4E9C	PUSH	HL
	LD	HL,L48D2
	DEC	(HL)
	POP	HL
	CALL	L4E6C
L4EA6	XOR	A
	RET 
L4EA8	LD	HL,0
	LD	D,0
	LD	IX,L4BF9
L4EB1	LD	A,(IX)
	SUB	"0"
	CP	#0A
	RET	NC
	LD	B,H
	LD	C,L
	ADD	HL,HL
	ADD	HL,HL
	ADD	HL,BC
	ADD	HL,HL
	LD	E,A
	ADD	HL,DE
	INC	IX
	JR	L4EB1
L4EC5	LD	IX,L4BF9
	XOR	A
	LD	(HL),A
	INC	HL
	LD	(HL),A
	DEC	HL
L4ECE	LD	A,(IX)
	CP	"F"+1
	JR	NC,L4EE7
	SUB	"0"
	CP	10
	JR	C,L4EDD
	SUB	7
L4EDD	RLD 
	INC	HL
	RLD 
	DEC	HL
	INC	IX
	JR	L4ECE
L4EE7	LD	E,(HL)
	INC	HL
	LD	D,(HL)
	EX	DE,HL
	RET 
L4EEC	PUSH	AF
	LD	B,A
	LD	A,#20
	SUB	B
	LD	B,A
L4EF2	CALL	L4FC5
	DJNZ	L4EF2
	POP	AF
	LD	(L48D2),A
	RET 
L4F60	PUSH	HL
	PUSH	BC
	CALL	L4F89
	LD	E,A
	POP	BC
	POP	HL
	RET 
L4F89	CALL	L4E60
L4F8C	LD	A,1
	LD	(#0F17),A
NOPRES	EI 
	LD	A,(#0F17)
	BIT	0,A
	JR	NZ,NOPRES
	DI 
	LD	A,(#0F09)
	RET 
L4FC5	LD	A," "
L4FC7	PUSH	HL
	PUSH	BC
	PUSH	DE
	PUSH	AF
	LD	HL,(L48D2)
	LD	A,L
	CP	32
L4FD0	EQU	$-1
	JR	NC,L4FFB
	INC	L
	LD	(L48D2),HL
	DEC	L
	LD	A,H
	ADD	A,A
	ADD	A,A
	ADD	A,A
	ADD	A,A
	ADD	A,A
	ADD	A,L
	LD	L,A
	POP	AF
	PUSH	AF
	AND	#3F
L4FF5	NOP 
	NOP 
	LD	C,#F4
	OUT	(#F5),A
	OUT	(C),L
L4FFB	POP	AF
	POP	DE
	POP	BC
	POP	HL
	RET 
L5000	LD	HL,(L4B8B)	;-8-
	LD	DE,8
	OR	A
	SBC	HL,DE
	LD	(L4B8B),HL
	RET 
L500D	CALL	L4A7C		;-O-
	LD	HL,POKTXT
	CALL	L4AA3
	LD	HL,(L4B8B)
	PUSH	HL
L501A	LD	HL,#705
	LD	(L48D2),HL
	LD	A,L
	CALL	L4EEC
	POP	HL
	PUSH	HL
	CALL	L4B60
	LD	A,","
	CALL	L4FC7
	CALL	L4D67
	POP	DE
	JP	C,L4A7C
	CALL	L4FC5
	EX	DE,HL
	LD	A,D
	OR	A
	LD	(HL),E
	INC	HL
	JR	Z,L5044
	LD	(HL),D
	INC	HL
L5044	PUSH	HL
	LD	B,7
	CALL	L4A8E
	JR	L501A
MONCOPY
	CALL	L4A7C
	LD	HL,MONCTXT
	CALL	L4AA3
	LD	A,#FF
	LD	(LENBL),A
	CALL	P_START
	LD	A,"N"
	LD	HL,0
	CALL	PERF1BT
	LD	A,128
	LD	HL,5381
	CALL	PERF1BT
	LD	DE,#4040
	LD	HL,EOF-#4040
	CALL	PERFBLO
	LD	A,32
	LD	HL,5377
	CALL	PERF1BT
	LD	A,#40
	LD	(LENBL),A
	JP	PERFOE2
PERF1BT	PUSH	AF
	LD	A,#A0
	CALL	PERFLIN
	LD	A,#3A
	CALL	PERFLIN
	LD	A,1
	LD	C,0
	CALL	PERFBYT
	LD	A,H
	CALL	PERFBYT
	LD	A,L
	CALL	PERFBYT
	XOR	A
	CALL	PERFBYT
	POP	AF
	CALL	PERFBYT
	LD	A,C
	NEG 
	CALL	PERFBYT
	LD	B,4
LUPP22	XOR	A
	CALL	PERFLIN
	DJNZ	LUPP22
	LD	A,#1E
	CALL	PERFLIN
	RET 
PERFO	CALL	L4A7C
	LD	HL,PERFTXT
	CALL	L4AA3
	OR	A
	EX	AF,AF'
	CALL	L50CF
	CALL	L4FC5
	JP	C,L4A7C
PERFBLO	PUSH	DE
	EXX 
	POP	HL	;HL'-START
	EXX 
	LD	A,(LENBL)
	LD	D,0	;HL-LEN
	LD	E,A
	LD	A,(FLAG)
	BIT	0,A
	JR	NZ,LUP_M
	CALL	P_START
LUP_M	AND	A
	SBC	HL,DE
	JP	M,OST_B
	LD	A,(LENBL)
	CALL	PERF1BL
	JR	LUP_M
OST_B	ADD	HL,DE
	LD	A,L
	AND	A
	JP	Z,L4A7C
	CALL	PERF1BL
	JP	L4A7C
PERFOEN	CALL	L4A7C
	LD	HL,PENDTXT
	CALL	L4AA3
PERFOE2	CALL	PERFEND
	CALL	P_STOP
	JP	L4A7C
PERFEND	LD	A,#A0
	CALL	PERFLIN
	LD	A,#3A
	CALL	PERFLIN
	LD	B,10
PENDL	LD	A,"0"
	CALL	PERFLIN
	DJNZ	PENDL
	LD	A,#1E
PERFLIN	CALL	#FF12
	JP	C,PHARDP
	RET 
PERF1BL	PUSH	HL
	PUSH	DE
	EXX 
	LD	B,A
	LD	A,#A0
	CALL	PERFLIN
	LD	A,#3A
	CALL	PERFLIN
	LD	A,B
	LD	C,0
	CALL	PERFBYT
	LD	A,H
	CALL	PERFBYT
	LD	A,L
	CALL	PERFBYT
	XOR	A
	CALL	PERFBYT
LUPP1	LD	A,(HL)
	CALL	PERFBYT
	INC	HL
	DJNZ	LUPP1
	LD	A,C
	NEG 
	CALL	PERFBYT
	LD	B,4
LUPP2	XOR	A
	CALL	PERFLIN
	DJNZ	LUPP2
	LD	A,#1E
	CALL	PERFLIN
	EXX 
	POP	DE
	POP	HL
	RET 
PERFBYT	PUSH	HL
	PUSH	DE
	PUSH	AF
	ADD	A,C
	LD	C,A
	POP	AF
	CALL	#FF43
	LD	A,D
	CALL	PERFLIN
	LD	A,E
	CALL	PERFLIN
	POP	DE
	POP	HL
	RET 
P_START	CALL	#FF0C
	PUSH	HL
	LD	HL,FLAG
	SET	0,(HL)
	POP	HL
	JP	C,PHARDP
	RET 
P_STOP	CALL	#FF0F
	LD	HL,FLAG
	RES	0,(HL)
	RET 
PHARDP	CALL	L4A7C
	LD	HL,HARDTXT
	CALL	L4AA3
	LD	HL,FLAG
	BIT	0,(HL)
	CALL	NZ,P_STOP
	BIT	1,(HL)
	CALL	NZ,R_STOP
	CALL	L4F8C
	LD	A,#40
	LD	(LENBL),A
	LD	SP,(L4B89)
	JP	L489D
R_START	CALL	#FF15
	PUSH	HL
	LD	HL,FLAG
	SET	1,(HL)
	POP	HL
	JP	C,PHARDP
	RET 
R_STOP	CALL	#FF18
	LD	HL,FLAG
	RES	1,(HL)
	RET 
KOPY	CALL	L4A7C
	LD	HL,KOPTXT
	CALL	L4AA3
	CALL	L4F8C
	CALL	R_START
	LD	A,(FLAG)
	BIT	0,A
	JR	NZ,KOPMAI
	CALL	P_START
KOPMAI	LD	HL,BUFER
	LD	BC,BUFLEN
LUPKOP	CALL	#FF1B
	JR	C,ERR_L1
	LD	(HL),A
	INC	HL
	DEC	BC
	LD	A,B
	OR	C
	JR	NZ,LUPKOP
	JR	NOERL
ERR_L1	CALL	R_STOP
	SCF 
NOERL	PUSH	AF
	LD	HL,BUFLEN
	AND	A
	SBC	HL,BC
	LD	C,L
	LD	B,H
	LD	HL,BUFER
LUPPER	LD	A,(HL)
	CALL	PERFLIN
	INC	HL
	DEC	BC
	LD	A,B
	OR	C
	JR	NZ,LUPPER
	POP	AF
	JR	NC,KOPMAI
	CALL	P_STOP
	JP	L4A7C
SAV_COD	CALL	L4A7C	;SAVE CODE
	LD	HL,SAVTXT
	CALL	L4AA3
	SCF 
	EX	AF,AF'
	CALL	L50CF
	CALL	L4FC5
	JP	C,L4A7C
	NOP 
	JP	L4A7C
L504C	CALL	L4A7C	;LOAD CODE
	LD	HL,LOATXT
	CALL	L4AA3
	OR	A
	EX	AF,AF'
	CALL	L50CF
	CALL	L4FC5
	JP	C,L4A7C
	PUSH	DE
	PUSH	DE	;ADR LOA
	PUSH	HL	;LEN
	LD	IX,L48D0
	LD	DE,1
	XOR	A
	SCF 
	EX	AF,AF'
	CALL	#0562
	POP	DE
	POP	IX
	CALL	#5A9
	LD	A,0
	OUT	(#FE),A
	POP	DE	;ADR LOA
	JR	C,L5098
	PUSH	AF
	CALL	L4A7C
	POP	AF
	JR	NZ,L50AD
	PUSH	IX
	LD	HL,L4B9B
	CALL	L4AA3
	CALL	L4AA3
	POP	HL
	DEC	HL
	SBC	HL,DE
	CALL	L4ABC
L5098	LD	HL,L4B96
	CALL	L4AA3
	LD	A,(L48D0)
	CALL	L4AAAF
	CALL	L4F8C
	JP	L4A7C
L50AD	LD	HL,L4B9B
	CALL	L4AA3
	JR	L5098
L50CF	CALL	L4D67
	RET	C
	PUSH	HL
	LD	A,","
	CALL	L4FC7
	CALL	L4D67
	POP	DE
	RET	C
	EX	AF,AF'
	RET	NC
	PUSH	DE
	PUSH	HL
	LD	HL,L4B96
	CALL	L4AA3
	LD	A,3
	CALL	L4D69
	CALL	L4FC5
	POP	DE
	POP	IX
	LD	A,L
	RET 
L50F5	CALL	L4A7C	;-I-
	LD	HL,FILTXT
	CALL	L4AA3
	LD	HL,L4BA8
	CALL	L4AA3
	CALL	L4D67
	JP	C,L4A7C
	PUSH	HL
	LD	HL,L4BAE
	CALL	L4AA3
	CALL	L4D67
	POP	DE
	JP	C,L4A7C
	PUSH	DE
	PUSH	HL
	CALL	L4A7C
	LD	HL,L4BD6
	CALL	L4AA3
L511B	CALL	L4F8C
	LD	C,#80
	CP	"1"
	JR	Z,L5142
	LD	C,#90
	CP	"2"
	JR	Z,L5142
	LD	C,7
	CP	"3"
	JR	Z,L515F
	LD	C,#0F
	CP	"4"
	JR	Z,L515F
	LD	C,#A8
	CP	"5"
	JR	Z,L5142
	LD	C,#78
	CP	"6"
	JR	NZ,L511B
L5142	PUSH	BC
	PUSH	AF
	CALL	L4A7C
	LD	A,#4B
	CALL	L4FC7
	POP	AF
	CALL	L4FC7
	LD	A,#3D
	CALL	L4FC7
	LD	A,3
	CALL	L4D69
	CALL	L4FC5
	POP	BC
	LD	B,L
L515F	POP	DE
	POP	HL
	JP	C,L4A7C
	LD	A,C
	LD	(L5168),A
L5167	LD	A,(HL)
L5168	NOP 
	LD	(HL),A
	OR	A
	SBC	HL,DE
	ADD	HL,DE
	INC	HL
	JR	NZ,L5167
	JP	L4A7C
L5174	CALL	L4A7C
	LD	HL,L4BA8
	CALL	L4AA3
	CALL	L4D67
	JP	C,L4A7C
	PUSH	HL
	LD	HL,L4BB4
	CALL	L4AA3
	CALL	L4D67
	POP	DE
	JP	C,L4A7C
	PUSH	DE
	PUSH	HL
	LD	HL,L4BA3
	CALL	L4AA3
	CALL	L4D67
	CALL	L4FC5
	LD	B,H
	LD	C,L
	POP	DE
	POP	HL
	JP	C,L4A7C
	OR	A
	SBC	HL,DE
	ADD	HL,DE
	JR	C,L51AD
	LDIR 
	JP	L4A7C
L51AD	ADD	HL,BC
	EX	DE,HL
	ADD	HL,BC
	EX	DE,HL
	DEC	HL
	DEC	DE
	LDDR 
	JP	L4A7C
L51B8	CALL	L4A7C
	LD	HL,L4BBD
	CALL	L4AA3
	CALL	L4D67
	JR	NC,L51DE
	CP	"+"
	JR	Z,L51D8
	CP	"-"
	JP	NZ,L4A7C
	CALL	L51EF
	JP	C,L4A7C
	OR	A
	SBC	HL,DE
	JR	L51DE
L51D8	CALL	L51EF
	JP	C,L4A7C
	ADD	HL,DE
L51DE	LD	A,"="
	CALL	L4FC7
	CALL	L4ABC
	CALL	L4F89
	JP	L4A7C
L51EF	CALL	L4FC7
	LD	A,(L4B8D)
	BIT	2,A
	JR	NZ,L51FE
	CALL	L4DB0
	JR	L5201
L51FE	CALL	L4CB7
L5201	PUSH	HL
	CALL	L4D67
	POP	DE
	EX	DE,HL
	RET 
L5208	CALL	L4A7C
	LD	HL,L4BBF
	CALL	L4AA3
	CALL	L4CC1
	JP	C,L4A7C
	LD	HL,(L4B8B)
	LD	DE,L4DBD
L521D	LD	A,(DE)
	CP	#80
	JP	NC,L4A7C
	LD	(HL),A
	INC	HL
	INC	DE
	JR	L521D
L5228	CALL	L4A7C
	LD	HL,L4BBB
	CALL	L4AA3
	CALL	L4CC1
	JP	C,L4A7C
	LD	A,#10
	SUB	B
	LD	(L4B8F),A
	CALL	L4FC5
	CALL	L52A1
	JP	L4A7C
L5245	CALL	L5288	;-G-
	LD	A,"@"
	LD	(L4FD0),A
	LD	HL,L4BC1
	CALL	L4AA3
	LD	C,10
	LD	DE,L4DBD
L5258	PUSH	BC
	PUSH	DE
	CALL	L4D67
	POP	DE
	POP	BC
	JR	C,L5288
	LD	B,A
	LD	A,(L48D1)
	CP	B
	JR	Z,L527C
	LD	A,","
	CALL	L4FC7
	LD	A,L
	LD	(DE),A
	INC	DE
	DEC	C
	JR	Z,L527C
	LD	A,H
	OR	A
	JR	Z,L5258
	LD	(DE),A
	INC	DE
	DEC	C
	JR	NZ,L5258
L527C	LD	A,10
	SUB	C
	LD	(L4B8F),A
	CALL	L4FC5
	CALL	L52A1
L5288	LD	HL,#600
	PUSH	HL
	CALL	L5291
	POP	HL
	INC	H
L5291	LD	(L48D2),HL
	CALL	L4A82
	DEC	H
	LD	(L48D2),HL
	LD	A," "
	LD	(L4FD0),A
	RET 
L52A1	LD	HL,(L4B8B)
	INC	HL
	LD	BC,#FFFF
L52A8	LD	A,(L4B8F)
	LD	(L48D1),A
	LD	DE,L4DBD
	LD	A,(DE)
	CPIR 
	PUSH	HL
L52B5	LD	A,(L48D1)
	DEC	A
	LD	(L48D1),A
	JR	Z,L52C7
	INC	DE
	LD	A,(DE)
	CPI 
	JR	Z,L52B5
	POP	HL
	JR	L52A8
L52C7	POP	HL
	DEC	HL
	LD	(L4B8B),HL
	RET 
L52CD	CALL	L4A7C	;-J-
	LD	HL,L4BB8
	CALL	L4AA3
	CALL	L4D67
	JR	C,L52E4
	CALL	L4FC5
	LD	SP,(L4B89)
	EI 
	JP	(HL)
L52E4	CALL	L4A7C
	JP	L48A0
L52EA	LD	HL,(L4B8B)
	PUSH	HL
	LD	DE,L4BF6
	LD	BC,3
	LDIR 
	POP	HL
	LD	DE,TURN
	LD	(HL),#CD
	INC	HL
	LD	(HL),E
	INC	HL
	LD	(HL),D
	RET 
TURN	DI 
	POP	DE
	DEC	DE
	DEC	DE
	DEC	DE
	LD	(L4B89),SP
	LD	HL,L4BF6
	LD	BC,3
	LDIR 
	JP	L489D
	INCLUDE	"FX128Z",1
	INCLUDE	"BUBU",7
;EN__	EQU	$-#4040
;	INCLUDE	"TRANS"


